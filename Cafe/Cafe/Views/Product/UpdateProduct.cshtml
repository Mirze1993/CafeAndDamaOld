@model UIProduct
@{
    ViewData["Title"] = "UpdateProduct";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h1>UpdateProduct</h1>
<div class="form-group row">
    <form enctype="multipart/form-data" method="post" asp-action="UpdateProduct">
        <input type="hidden" asp-for="Id" />
        <input type="hidden" asp-for="ImgPath" />
        <label asp-for="Name" class="col-sm-2 col-form-label">Adi</label>
        <div class="col-sm-10">
            <input asp-for="Name" class="form-control" />
        </div>

        <label asp-for="Description" class="col-sm-2 col-form-label">Açıqlama</label>
        <div class="col-sm-10">
            <input asp-for="Description" class="form-control" />
        </div>

        <div class="col-sm-10">
            <label asp-for="Price">Qiyməti</label>
            <input asp-for="Price" pattern="[0-9]+([.][0-9]+)?" />
        </div>


        <div class="col-sm-10 cus">

            <label asp-for="Img">Photo</label>
            <input type="file" class="form-control-file" asp-for="Img">
        </div>

        <div class="form-group row">
            <div class="col-sm-10 offset-sm-1">
                <button type="submit" class="btn btn-primary">Yadda saxla</button>
            </div>
        </div>
    </form>
</div>


@if (Model != null)
{
    <div>
        @{var filePath = "~/userimg/" + (Model.ImgPath ?? "img.jpg"); }
        <!--image-->
        <div class="card" style="width: 18rem;">
            <img asp-append-version="true" class="card-img-top" src=@filePath />"
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <a href="#" class="btn btn-primary">Go somewhere</a>
            </div>
        </div>

        @{string katname = Model.SubCategoryName ?? "secilmeyib";}
        Katiqorya:@katname
        <a onclick="categoryLoad()" id="categoryLoader" class="btn btn-sm btn-success">
            <i class="fa fa-edit"></i>
        </a>
        <div id="divSelectCategory" style="display:none">
            <select id="SubCategorySelect" class="selectpicker show-menu-arrow"> </select>
            <a onclick="SaveChange()" class="btn btn-sm btn-success">
                <i class="fa fa-save"></i>
            </a>
            <a onclick="Cancel()" class="btn btn-sm btn-danger">
                <i class="fa fa-times"></i>
            </a>
        </div>

    </div>

    @section Scripts{
        <script>

        function categoryLoad() {
         $.ajax({
                method: "POST",
                url: "@Url.Action("SubCatigoryForDropDown","SubCategory")",
                type: "text",
                success: function (msg) {
                    var obj = jQuery.parseJSON(msg);
                    $(obj).each(function (i, value) {
                        console.log(value.Id);
                        $("#SubCategorySelect").append($("<option>")
                            .val(value.Id)
                            .html(value.Name)
                        );
                    });
                    $("#divSelectCategory").show();
                    $("#categoryLoader").hide();
                },
             error: function (msg) {

                }

            });
        }

        function SaveChange() {
            var id =@Model.Id;
            var catId = $("#SubCategorySelect").val();
            console.log(catId);
         $.ajax({
                method: "POST",
                url: "@Url.Action("SaveSubCategory")",
                type: "text",
                data: {
                    catId: catId,
                    id: id
                },
                success: function (msg) {
                    alert(msg);
                },
             error: function (msg) {

                }

            });
            }
            function Cancel() {
                $("#divSelectCategory").hide();
                $("#categoryLoader").show()
            }

        </script>
    }
}

